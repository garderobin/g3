qing.registNS("qelm");(function(b){var a={classContainerName:"input-box-container",className:"input-box",classRealName:"input-box-real",classFocus:"input-box-focus",classNotEmpty:"input-box-notempty",classHover:"input-box-hover",classLabelName:"input-label",classLabelHover:"input-label-hover",classLabelFocus:"input-label-focus"},c=function(d){return qing.dom.query("."+a.className,d)[0]};_getLabel=function(d){return qing.dom.query("."+a.classLabelName,d)[0]};checkEmpty=function(e){var f=e;var d=_getLabel(qing.dom.getParent(e));if(e.value!=""){qing.dom.addClass(f,a.classNotEmpty);if(!qing.dom.hasClass(d,"hide")){d.style.display="none"}}else{qing.dom.removeClass(f,a.classNotEmpty);if(!qing.dom.hasClass(d,"hide")){d.style.display="block"}}},inputMouseover=function(f){var g=this;var e=qing.dom.getParent(this);var d=_getLabel(e);if(!qing.dom.hasClass(g,a.classFocus)){qing.dom.addClass(g,a.classHover);qing.dom.addClass(d,a.classLabelHover)}},inputMouseout=function(f){var g=this;var e=qing.dom.getParent(this);var d=_getLabel(e);if(!qing.dom.hasClass(g,a.classFocus)){qing.dom.removeClass(g,a.classHover);qing.dom.removeClass(d,a.classLabelHover)}},inputFocus=function(f){var g=this;var e=qing.dom.getParent(this);var d=_getLabel(e);qing.dom.removeClass(g,a.classHover);qing.dom.addClass(g,a.classFocus);qing.dom.removeClass(d,a.classLabelHover);qing.dom.addClass(d,a.classLabelFocus);checkEmpty(this)},inputBlur=function(f){var g=this;var e=qing.dom.getParent(this);var d=_getLabel(e);qing.dom.removeClass(g,a.classHover);qing.dom.removeClass(g,a.classFocus);qing.dom.removeClass(d,a.classLabelHover);qing.dom.removeClass(d,a.classLabelFocus);checkEmpty(this)},inputKeydown=function(f){var e=qing.dom.getParent(this);var d=_getLabel(e);d.style.display="none"};labelClick=function(f){var e=qing.dom.getParent(this);var d=c(e);d.focus()},labelMouseover=function(g){var f=qing.dom.getParent(this);var d=c(f);var e=this;if(!qing.dom.hasClass(d,a.classFocus)){qing.dom.addClass(d,a.classHover);qing.dom.addClass(e,a.classLabelHover)}};labelMouseout=function(f){var e=qing.dom.getParent(this);var d=c(e)},init=function(f){var d=c(f);var e=_getLabel(f);checkEmpty(d);qing.on(d,"focus",inputFocus);qing.on(d,"blur",inputBlur);qing.on(d,"keydown",inputKeydown);qing.on(d,"mouseover",inputMouseover);qing.event.on(document,"mouseover",function(g){var h=qing.event.getTarget(g);if(h!=f&&!qing.dom.contains(f,h)&&h!=e&&!qing.dom.contains(e,h)){qing.dom.removeClass(d,a.classHover);qing.dom.removeClass(e,a.classLabelHover)}else{qing.dom.addClass(d,a.classHover);qing.dom.addClass(e,a.classLabelHover)}});qing.on(e,"click",labelClick)},flicker=function(e){var h=200,f=2,d=f*2+1;var g=function(){d--;if(d%2==0){qing.dom.addClass(e,"input-box-warning")}else{qing.dom.removeClass(e,"input-box-warning")}if(d<1){qing.dom.removeClass(e,"input-box-warning");return}setTimeout(g,h)};g()};qing.dom.ready(function(){var f=qing.q(a.classContainerName),e;for(var d in f){e=f[d];init(e)}});b.inputbox=b.inputbox||{};b.inputbox.init=init;b.inputbox.flicker=flicker})(qelm);qing.registNS("qui");qui.tab=(function(){var d=function(e){};var b={container:['<div class="tab clearfix">','<div class="tab-vernier"></div>','<ul class="tab-ul">',"#{li}","</ul>","</div>",'<div class="tab-bottom-line"></div>'].join(""),li:['<li class="tab-li #{class}">',"#{text}","</li>"].join(""),a:'<a class="#{class}" href="#{href}" target="#{target}">#{name}</a>',span:'<span class="#{class}">#{name}</span>'};var c=function(f){var e=[],k,j,h;for(var g in f){k=f[g];j=k["class"];liClass="";if(/^[\x20-\x7E]+$/.test(g)){liClass="tab-li-ascii"}if(k.selected){liClass=[liClass,"tab-li-selected"].join(" ")}if(k.href){e.push(qing.string.format(b.li,{text:qing.string.format(b.a,{href:k.href,target:k.target||"_self","class":j,name:g}),"class":liClass}))}else{e.push(qing.string.format(b.li,{text:qing.string.format(b.span,{"class":j,name:g}),"class":liClass}))}}h=qing.string.format(b.container,{li:e.join("")});return h};var a={init:d,getHTML:c};return a})();qing.registNS("qelm");qelm.msgeditor=(function(){var n=['<div class="qelm-msgeditor clearfix">','<div class="qelm-msgeditor-toolbar">','<ul class="toolbar-inner">','<li class="toolbar-item toolbar-face">',"</li>","</ul>","</div>",'<div class="qelm-msgeditor-editorbox">','<label for="#{textareaname}" class="msglabel">#{labelText}</label>','<textarea name="#{textareaname}" class="msgtextarea"></textarea>',"</div>","</div>"];var a={classFocus:"qelm-msgeditor-focus",classHover:"qelm-msgeditor-hover"};var i=function(r){if(o(r).value!=""){q(r).style.display="none"}else{q(r).style.display="block"}};var j=function(s,r){if(!qing.dom.hasClass(h(s),a.classFocus)){qing.dom.addClass(h(s),a.classHover)}};var p=function(s,r){qing.dom.removeClass(h(s),a.classHover)};var c=function(s,r){i(s);qing.dom.removeClass(h(s),a.classHover);qing.dom.addClass(h(s),a.classFocus)};var k=function(s,r){i(s);qing.dom.removeClass(h(s),a.classFocus)};var b=function(s,r){q(s).style.display="none"};var f=function(s,r){o(s).focus()};var o=function(t){var s=qing.g(t);var r=qing.dom.query(".msgtextarea",s)[0];return r};var h=function(s){var r=qing.g(s);var t=qing.dom.query(".qelm-msgeditor",r)[0];return t};var q=function(t){var s=qing.g(t);var r=qing.dom.query(".msglabel",qing.g(s))[0];return r};var e=function(t){var s=o(t);s.disabled=true;var r=l(t,"face");r.style.display="none"};var g=function(t){var s=o(t);s.disabled=false;var r=l(t,"face");r.style.display="block"};var d=function(w,r){var t=qing.g(w);var y=r.textareaname;var s=n.join("");s=s.replace(/#{textareaname}/g,y);s=s.replace(/#{labelText}/g,r.labelText);t.innerHTML=s;var x=h(t);var v=o(t);var u=q(t);i(w);qing.on(v,"focus",function(z){c(w,z)});qing.on(v,"blur",function(z){k(w,z)});qing.on(v,"keydown",function(z){b(w,z)});qing.on(x,"mouseover",function(z){j(w,z)});qing.on(x,"mouseout",function(z){p(w,z)});qing.on(u,"click",function(z){f(w,z)})};var m=function(u,t,r){var s=o(u);if(t=="face"){var v=l(u,"face");qcmt.Face.init(s,v,{left:r.left,top:r.top})}};var l=function(s,t){var r;if(t=="face"){r=qing.dom.query(".toolbar-face",qing.g(s))[0]}return r};return{initialize:d,initToolbar:m,getToolbar:l,getTextArea:o,getElmLabel:q,enabled:g,disabled:e}})();qing.registNS("qcmt");qcmt.Face=(function(){var e="http://img.baidu.com/hi/";var b={"精选":{folder:"jx2",prefix:"j_00",background:"qing/face/preview/jxFace.gif",face:{"兔斯基":["亲亲","love","哦耶","恐怖","扭屁股","强顶","抖胸","88","汗","瞌睡","鲁拉","拍砖","揉脸","生日快乐"],"绿豆蛙":["掩嘴笑","瀑布汗~","吃惊","臭美","傻笑","抛媚眼","发怒","打酱油","俯卧撑","气愤","颤抖","吻","怒","胜利"],BOBO:["hi","啵一个","不说","不要","寂寞","花心","我顶","大惊","飞吻","鬼脸","娇羞","口水","大哭","勾引"],"baby猫":["发财了","吃西瓜","套牢","小女人","庆祝","我来也","敲打","好多金子","O液","美美","被打","贪吃","迎接","得瑟"],"泡泡":["微笑","大笑","嘻嘻","紧张","酷","生气","阴险","一滴汗","哭","憨憨的","鄙视","好困","牛","晕了"],"有啊":["开心","偷笑","痛哭","滴汗","叹气","超赞","囧","献吻","可怜","撒花","怒火","砸扁","吓傻","吐"]}},"兔斯基":{folder:"tsj",prefix:"t_00",background:"qing/face/preview/tFace.gif",face:["亲亲","love","哦耶","恐怖","扭屁股","强顶","抖胸","88","汗","瞌睡","鲁拉","拍砖","揉脸","生日快乐","摊手","睡觉","瘫坐","无聊","星星闪","旋转","没门儿","郁闷","high","抓墙","撞墙","疑问","戳眼","飘过","互相拍砖","砍死你","扔桌子","跳舞","什么？","转头","我爱牛奶","我踢","摇晃","晕厥","在笼子里","震荡"]},"绿豆蛙":{folder:"ldw",prefix:"w_00",background:"qing/face/preview/wFace.gif",face:["掩嘴笑","瀑布汗~","吃惊","臭美","傻笑","抛媚眼","发怒","我错了","money","气愤","挑逗","吻","怒","胜利","太委屈","受伤","白眼","闭嘴","不","逗你玩儿","姆啊","眩晕","魔法","我来了","睡了","我打","shut up","连环拳","打晕了","刷牙","爆炸","炸弹","倒立","刮胡子","邪恶的笑","使小性子","爱恋中","放大镜","偷窥","超高兴","晕","松口气","我跑","享受","装 13","掉泪","冷汗","惊恐","热烈欢迎","打酱油","俯卧撑","颤抖"]},BOBO:{folder:"bobo",prefix:"B_00",background:"qing/face/preview/bFace.gif",face:["hi","啵一个","不说","不要","寂寞","花心","我顶","大惊","飞吻","鬼脸","娇羞","口水","大哭","勾引","舍不得","难过","哼","吐舌","喜欢","转圈","再见","抓狂","我去!","切","膜拜","吐血","嘘","揍你","跳跳","变脸","扯肉","吃 to","吃花","吹泡泡","变身","飞天舞","回眸","凄惨","猛抽","泡泡","花痴","亲你","撒娇","骚舞","烧香","大睡","套娃娃","挨批评","街舞","西红柿","爱慕","折磨","摇摆","杂耍","招财","挨打","被球闷","霹雳","理想","欧打","呕吐","碎","吐痰"]},"baby猫":{folder:"babycat",prefix:"C_00",background:"qing/face/preview/cFace.gif",face:["发财了","吃西瓜","套牢","小女人","庆祝","我来也","敲打","好多金子","O液","美美","被打","贪吃","迎接","得瑟","UP顶","幸运","爱心","登场","送花","选择"]},"泡泡":{folder:"face",prefix:"i_f",background:"qing/face/preview/fFace.gif",face:["微笑","大笑","嘻嘻","紧张","酷","生气","阴险","一滴汗","哭","憨憨的","鄙视","好困","牛","晕了","不懂","尴尬","吐","害羞","委屈","亲","谄笑","爱情","心碎","玫瑰","礼物","哈哈笑","得意","可爱","色","眨眼","狂汗","楚楚可怜","困","害怕","威武","惊讶","喷","彩虹","月亮","太阳","金币","灯泡","咖啡","蛋糕","音乐","爱你","Victory","顶","踩","OK","气球"]},"有啊":{folder:"youa",prefix:"y_00",background:"qing/face/preview/yFace.gif",face:["男兜","女兜","开心","乖乖","偷笑","咔咔","抽泣","痛哭","无奈","滴汗","叹气","狂晕","好委屈","超赞","囧","不明白","献吻","可怜","撒花","怒火","砸扁","淫荡","泪奔","吓傻","吐舌头","点头","吐","转体","打呼","BS你","狂顶","篮球","拜拜","欢迎光临","恭喜发财","稍等","我在线","恕不议价","库房有货","货在路上"]}};var c=null;var d={entrance:undefined,element:qing.dom.create("div",{"class":"qcmt-face-dialog"}),tpl:{img:'<img class="#{class}" src="#{src}" alt="#{alt}" title="#{title}" />',container:['<div class="qcmt-face-dialog-container">','<div class="qcmt-face-dialog-tab">',"#{tab}","</div>",'<div class="qcmt-face-dialog-icon">','<div class="qcmt-face-dialog-icon-preview clearfix" style="display: none;"></div>','<ul class="qcmt-face-dialog-icon-ul clearfix">',"#{icon}","</ul>","</div>","</div>"].join(""),icon:['<li class="qcmt-face-dialog-icon-li">','<span class="qcmt-face-dialog-icon-lispan" title="#{title}" data-gif="#{gif}" data-text="#{text}" style="background-image:url(#{bg}); background-position: left #{position}px;">',"</span>","</li>"].join(""),getTabBar:function(k){var l="",i={};for(var h in b){i[h]={"class":"qcmt-face-dialog-tab-li",selected:(h==k)?true:false}}return qui.tab.getHTML(i)},getIcons:function(m){var w=b[m],z=w.face,A="",u=this,x=0,n=25;if(qing.lang.isArray(z)){for(var t=0,o=z.length;t<o;t++){A+=qing.string.format(u.icon,{bg:[e,"/",w.background].join(""),position:x,title:z[t],gif:[w.folder,"/",w.prefix,qing.number.pad(t+1,2),".gif"].join(""),text:["[",m,":",z[t],"]"].join("")});x-=n}}else{if(qing.lang.isObject(z)){for(var q in z){for(var r=0,s=z[q].length;r<s;r++){var y=z[q][r];var h=qing.array.indexOf(b[q].face,y);A+=qing.string.format(u.icon,{bg:[e,"/",w.background].join(""),position:x,title:y,gif:[b[q].folder,"/",b[q].prefix,qing.number.pad(h+1,2),".gif"].join(""),text:["[",q,":",y,"]"].join("")});x-=n}}}}return A},format:function(m){var n=this,j="";if(!m){for(var l in b){m=l;break}}var h=n.getTabBar(m),k=n.getIcons(m);j=qing.string.format(n.container,{tab:h,icon:k});return j}},event:{init:function(){var h=this;h.ie.init()},ie:{init:function(){var h=this;h.inputRange=h.hoverRange},entranceHover:function(i){var h=this;if(document.selection){var j=document.selection.createRange().duplicate();h.hoverRange=j}}},insertFace:function(l,i){var j=this;if("selectionStart" in l){if(j._insertFace){return j._insertFace(l,i)}j._insertFace=function(o,n){var q=o.selectionStart,m=o.selectionEnd,p=o.value;o.value=[p.substr(0,q),n,p.substr(m,p.length)].join("");o.selectionStart+=n.length;o.selectionEnd=o.selectionStart;o.focus()};j._insertFace(l,i)}else{if(document.selection){var k=j.ie.inputRange;if(k&&k.parentElement()==l){k.text=i}else{l.value=[l.value,i].join("")}if(l.createTextRange){var h=l.createTextRange();h.moveStart("character",l.value.length);h.collapse();h.select()}l.focus&&l.focus()}}},click:function(h){var j=h.target||h.srcElement;if(qing.dom.hasClass(j,"qcmt-face-dialog-icon-lispan")){qext.stat.ns("m_20120921_face_click");var l=qing.dom.getAncestorByClass(d.entrance,"qcmt-input-box");var i=c;if(i){d.event.insertFace(i,qing.dom.getAttr(j,"data-text"))}}else{if(qing.dom.hasClass(j,"qcmt-face-dialog-tab-li")){var k=j.innerHTML;d.selectTab(k);qing.event.stop(h)}else{var m=qing.dom.getAncestorByClass(j,"qcmt-face-dialog");if(m){qing.event.stop(h)}}}},clock:{hidePreviewer:undefined,resize:undefined},mouseout:function(j){var k=j.target||j.srcElement;if(qing.dom.hasClass(k,"qcmt-face-dialog-icon-lispan")){if(qing.browser.ie==6){var i=qing.dom.getAncestorByClass(k,"qcmt-face-dialog-icon-li");if(i){qing.dom.removeClass(i,"qcmt-face-dialog-icon-lihover")}}d.event.clock.hidePreviewer=setTimeout(function(){var m=qing.q("qcmt-face-dialog-icon-preview",qing.dom.getAncestorByClass(k,"qcmt-face-dialog-icon"))[0];qing.dom.hide(m)},80)}var h;if(qing.dom.hasClass(k,"tab-li")){h=k}else{var l=qing.dom.getAncestorByClass(k,"tab-li");if(l){h=l}}if(h&&qing.dom.hasClass(h,"tab-li-hover")){qing.dom.removeClass(h,"tab-li-hover")}},mouseover:function(o){var k=o.target||o.srcElement;if(qing.dom.hasClass(k,"qcmt-face-dialog-icon-lispan")){if(qing.browser.ie==6){var p=qing.dom.getAncestorByClass(k,"qcmt-face-dialog-icon-li");if(p){qing.dom.addClass(p,"qcmt-face-dialog-icon-lihover")}}clearTimeout(d.event.clock.hidePreviewer);var l=[e,qing.dom.getAttr(k,"data-gif")].join("");l=qing.string.format(d.tpl.img,{src:l});var j=qing.q("qcmt-face-dialog-icon-preview",qing.dom.getAncestorByClass(k,"qcmt-face-dialog-icon"))[0];j.innerHTML=l;var m=2*(o.clientX-qing.dom.getPosition(d.element).left);if(parseInt(m,10)>d.element.offsetWidth){qing.dom.setStyles(j,{right:"auto",left:0})}else{var n=0;if(qing.browser.ie==6){n=14}qing.dom.setStyles(j,{right:n,left:"auto"})}qing.dom.show(j)}var h;if(qing.dom.hasClass(k,"tab-li")){h=k}else{var i=qing.dom.getAncestorByClass(k,"tab-li");if(i){h=i}}if(h&&!qing.dom.hasClass(h,"tab-li-hover")&&!qing.dom.hasClass(h,"tab-li-selected")){qing.dom.addClass(h,"tab-li-hover")}},resize:function(h){clearTimeout(d.event.clock.resize);d.event.clock.resize=setTimeout(function(){qing.dom.setStyles(d.element,{left:qing.dom.getPosition(d.entrance).left,top:qing.dom.getPosition(d.entrance).top+d.entrance.offsetHeight})},10)},bind:function(){var i=this;var h=d.element;qing.on(h,"click",i.click);qing.on(h,"mouseover",i.mouseover);qing.on(h,"mouseout",i.mouseout);qing.on(window,"resize",i.resize)},unbind:function(){var i=this;var h=d.element;qing.un(h,"click",i.click);qing.un(h,"mouseout",i.mouseout);qing.un(window,"resize",i.resize)}},selectTab:function(h){var i=this;h=h||"";i.element.innerHTML=i.tpl.format(h)},show:function(h,i){qing.event.fire(document,"click");var j=this;j.entrance=h;i=i||{};qing.dom.setStyles(j.element,{position:i.position||"absolute","z-index":i.zIndex||500,left:i.left||qing.dom.getPosition(j.entrance).left,top:i.top||qing.dom.getPosition(j.entrance).top+j.entrance.offsetHeight});j.selectTab();document.body.appendChild(j.element);j.event.init();j.event.bind();setTimeout(function(){qing.event.once(document,"click",function(){j.remove()})},100)},remove:function(){var h=this;h.event.unbind();qing.dom.remove(h.element)}};var g=function(j){var h=j;var l=[];for(var k in b){l.push(k)}var n=["\\[(",l.join("|"),")\\:([^\\[\\]]+)\\]"].join("");var m=new RegExp(n,"g");h=j.replace(m,function(o,i,r){if(b[i]&&b[i].face){var q=qing.array.indexOf(b[i].face,r);if(q!=-1){var p="face-icon";q=q+1;o=qing.string.format(d.tpl.img,{src:[e,b[i].folder,"/",b[i].prefix,qing.number.pad(q,2),".gif"].join(""),alt:r,title:r,"class":p})}}return o});return h};var f=function(i,j,h){if(!i){return}if(!j){return}h=h||{};c=i;qing.on(j,"click",function(k){d.show(this,h)});if(qing.browser.ie){qing.on(j,"mouseover",function(){d.event.ie.entranceHover(this)})}};var a={init:f,parse:g};return a})();